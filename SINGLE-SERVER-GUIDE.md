# ğŸ–¥ï¸ Guide DÃ©ploiement - 1 Serveur Hostinger 16GB

## ğŸ¯ **Configuration Serveur Unique**

### ğŸ“Š **Pourquoi 10 Instances sur 1 Serveur ?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Serveur Hostinger 16GB                   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Instance #1  â”‚  â”‚Instance #2  â”‚  â”‚Instance #3  â”‚     â”‚
â”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚     â”‚
â”‚  â”‚~800MB RAM   â”‚  â”‚~800MB RAM   â”‚  â”‚~800MB RAM   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Instance #4  â”‚  â”‚Instance #5  â”‚  â”‚Instance #6  â”‚     â”‚
â”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Instance #7  â”‚  â”‚Instance #8  â”‚  â”‚Instance #9  â”‚     â”‚
â”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚  â”‚40 comptes WAâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚Instance #10 â”‚                     â”‚
â”‚                    â”‚40 comptes WAâ”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                         â”‚
â”‚  ğŸ“Š Total: 400 comptes WhatsApp                        â”‚
â”‚  ğŸ’¾ RAM utilisÃ©e: ~10GB / 16GB disponibles             â”‚
â”‚  âš¡ CPU utilisÃ©e: ~4 vCPU / 8 vCPU disponibles         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### âœ… **Avantages du Serveur Unique**

| Aspect | Avantage | Explication |
|--------|----------|-------------|
| **ğŸ’° CoÃ»t** | 75â‚¬/mois | Le moins cher pour commencer |
| **ğŸ”§ SimplicitÃ©** | Setup rapide | 1 seul serveur Ã  gÃ©rer |
| **ğŸš€ Performance** | Bonne | 400 comptes supportÃ©s |
| **ğŸ“ˆ Ã‰volution** | Facile | Ajout de serveurs simple |

### âš ï¸ **Limites du Serveur Unique**

| Aspect | Limitation | Solution |
|--------|------------|----------|
| **ğŸ›¡ï¸ DisponibilitÃ©** | Single point of failure | Ajouter un 2Ã¨me serveur |
| **ğŸ“Š CapacitÃ©** | 400 comptes max | Scaling horizontal |
| **ğŸ”„ Maintenance** | Downtime nÃ©cessaire | Docker Swarm plus tard |

## â° **DÃ©ploiement Express - 2 Heures**

### ğŸ• **Planning Ultra-Rapide**

| Heure | Ã‰tape | DurÃ©e | Action |
|-------|-------|-------|--------|
| **14h-15h** | Installation | 1h | `setup-vps.sh` |
| **15h-16h** | DÃ©ploiement | 1h | `deploy-single-16gb.sh` |
| **16h-16h30** | Tests | 30min | Validation |

### ğŸš€ **Commandes de DÃ©ploiement**

#### **Ã‰tape 1 : Installation Serveur (1h)**
```bash
# Sur votre serveur Hostinger
scp -r production/ root@IP_SERVEUR:/root/evolution_api/
ssh root@IP_SERVEUR

cd evolution_api
chmod +x production/setup-vps.sh
./production/setup-vps.sh

# RÃ©pondre aux questions :
# ğŸŒ Domaine : evolution.wazzap.fr
# ğŸ“§ Email : votre@email.com
# ğŸ”‘ API Key : B6D711FCDE4D4FD5936544120E713C37
```

#### **Ã‰tape 2 : DÃ©ploiement API (1h)**
```bash
# DÃ©ploiement automatique
./production/deploy-single-16gb.sh

# Le script va :
# âœ… Tester les services externes
# âœ… Configurer les variables d'environnement
# âœ… DÃ©marrer Traefik + SSL
# âœ… DÃ©marrer 10 instances Evolution API
# âœ… Tester la connectivitÃ©
```

#### **Ã‰tape 3 : Validation (30min)**
```bash
# Tests rapides
curl https://evolution.wazzap.fr/
curl https://traefik.wazzap.fr/

# CrÃ©er une instance de test
curl -X POST \
  -H "apikey: B6D711FCDE4D4FD5936544120E713C37" \
  -H "Content-Type: application/json" \
  -d '{"instanceName": "test-single", "qrcode": true}' \
  https://evolution.wazzap.fr/instance/create
```

## ğŸ“Š **Utilisation des Ressources**

### ğŸ’¾ **RÃ©partition RAM (16GB Total)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SystÃ¨me Ubuntu        â”‚ 2GB   â”‚ 12% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Docker Engine         â”‚ 1GB   â”‚ 6%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Traefik              â”‚ 512MB â”‚ 3%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10 Instances API     â”‚ 10GB  â”‚ 62% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cache Local          â”‚ 1GB   â”‚ 6%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Marge SÃ©curitÃ©       â”‚ 1.5GB â”‚ 9%  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Total UtilisÃ© : ~14.5GB / 16GB âœ…
```

### âš¡ **RÃ©partition CPU (8 vCPU Total)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SystÃ¨me              â”‚ 1 vCPU â”‚ 12% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Docker + Traefik     â”‚ 1 vCPU â”‚ 12% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10 Instances API     â”‚ 4 vCPU â”‚ 50% â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Marge Disponible     â”‚ 2 vCPU â”‚ 25% â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Total UtilisÃ© : ~6 vCPU / 8 vCPU âœ…
```

## ğŸ”§ **Gestion Post-DÃ©ploiement**

### ğŸ“ˆ **Scaling sur 1 Serveur**

```bash
# Augmenter les instances (prudent)
docker-compose -f docker-compose-single-16gb.yml scale evolution-api=12

# Maximum recommandÃ© sur 16GB
docker-compose -f docker-compose-single-16gb.yml scale evolution-api=14

# Revenir Ã  l'optimal
docker-compose -f docker-compose-single-16gb.yml scale evolution-api=10
```

### ğŸ“Š **Monitoring Simple**

```bash
# Script de monitoring serveur unique
cat > monitor-single.sh << 'EOF'
#!/bin/bash

echo "ğŸ“Š Monitoring Serveur Unique 16GB"
echo "================================="

echo "ğŸ’¾ Utilisation RAM :"
free -h

echo ""
echo "âš¡ Utilisation CPU :"
top -b -n1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1

echo ""
echo "ğŸ“¦ Conteneurs Evolution API :"
docker-compose -f docker-compose-single-16gb.yml ps evolution-api

echo ""
echo "ğŸŒ Test connectivitÃ© :"
curl -s https://evolution.wazzap.fr/ | jq -r '.message' || echo "API inaccessible"

echo ""
echo "ğŸ“Š Instances WhatsApp actives :"
curl -s -H "apikey: B6D711FCDE4D4FD5936544120E713C37" \
  https://evolution.wazzap.fr/instance/fetchInstances | jq length

echo ""
echo "ğŸ’½ Espace disque :"
df -h | grep -E "/$|/var"
EOF

chmod +x monitor-single.sh
```

## ğŸ“ˆ **Plan d'Ã‰volution**

### ğŸ”„ **Quand Ajouter un 2Ã¨me Serveur ?**

**Indicateurs :**
- âœ… RAM > 80% utilisÃ©e constamment
- âœ… Plus de 300 comptes WhatsApp connectÃ©s
- âœ… Temps de rÃ©ponse API > 2 secondes
- âœ… Besoin de haute disponibilitÃ©

### ğŸš€ **Migration vers 2 Serveurs**

```bash
# 1. Provisionner le 2Ã¨me serveur
# 2. Installer avec setup-vps.sh
# 3. Configurer Docker Swarm :

# Sur serveur actuel (devient Manager)
docker swarm init --advertise-addr IP_SERVEUR_1

# Sur nouveau serveur (Worker)
docker swarm join --token TOKEN IP_SERVEUR_1:2377

# 4. Migrer vers configuration Swarm
docker stack deploy -c production/docker-swarm-2servers.yml evolution
```

## ğŸ’° **CoÃ»t Serveur Unique**

### ğŸ·ï¸ **CoÃ»t Mensuel**

| Composant | Prix/mois | Description |
|-----------|-----------|-------------|
| **Hostinger VPS 16GB** | 25â‚¬ | Serveur principal |
| **Neon PostgreSQL** | 20â‚¬ | Base de donnÃ©es |
| **Redis Cloud** | 25â‚¬ | Cache |
| **Domaine + SSL** | 0â‚¬ | Let's Encrypt |
| **Total** | **70â‚¬/mois** | **Pour 400 comptes** |

### ğŸ“Š **ROI**
- **CoÃ»t par compte** : 0.175â‚¬/mois
- **RentabilitÃ©** : Excellent pour commencer
- **Ã‰volution** : CoÃ»t/compte diminue avec le scaling

## ğŸ†˜ **DÃ©pannage Serveur Unique**

### â“ **ProblÃ¨mes Courants**

**RAM insuffisante :**
```bash
# RÃ©duire les instances
docker-compose -f docker-compose-single-16gb.yml scale evolution-api=8

# Surveiller
free -h
docker stats
```

**Performance lente :**
```bash
# VÃ©rifier la charge
top
htop

# Optimiser les logs
# Changer LOG_LEVEL=ERROR dans .env
docker-compose -f docker-compose-single-16gb.yml restart evolution-api
```

**SSL ne fonctionne pas :**
```bash
# Logs Traefik
docker-compose -f docker-compose-single-16gb.yml logs traefik

# VÃ©rifier DNS
nslookup evolution.wazzap.fr
```

## âœ… **Checklist Serveur Unique**

### ğŸ“‹ **Avant DÃ©ploiement**
- [ ] 1 serveur Hostinger 16GB provisionnÃ©
- [ ] DNS configurÃ© (evolution.wazzap.fr)
- [ ] AccÃ¨s SSH au serveur
- [ ] Neon PostgreSQL accessible
- [ ] Redis Cloud accessible

### ğŸ“‹ **Pendant DÃ©ploiement**
- [ ] `setup-vps.sh` exÃ©cutÃ© avec succÃ¨s
- [ ] `deploy-single-16gb.sh` exÃ©cutÃ©
- [ ] SSL gÃ©nÃ©rÃ© automatiquement
- [ ] 10 instances API dÃ©marrÃ©es

### ğŸ“‹ **AprÃ¨s DÃ©ploiement**
- [ ] API accessible via HTTPS
- [ ] Dashboard Traefik fonctionnel
- [ ] Instance WhatsApp de test crÃ©Ã©e
- [ ] Webhook Wazzap testÃ©

## ğŸŠ **RÃ©sultat Final**

Ã€ la fin du dÃ©ploiement (2h), vous aurez :

âœ… **1 serveur** optimisÃ© et sÃ©curisÃ©
âœ… **10 instances Evolution API** avec load balancing
âœ… **SSL automatique** avec Let's Encrypt
âœ… **Dashboard Traefik** pour monitoring
âœ… **Webhook Wazzap** intÃ©grÃ©
âœ… **CapacitÃ©** : 400 comptes WhatsApp
âœ… **CoÃ»t** : 70â‚¬/mois

## ğŸš€ **Commande Magique**

**AprÃ¨s avoir configurÃ© DNS et provisionnÃ© le serveur :**

```bash
# Sur votre serveur Hostinger
./production/setup-vps.sh
./production/deploy-single-16gb.sh
```

**Et voilÃ  ! API prÃªte en 2 heures !** âš¡

---

## ğŸ” **Comparaison des Options**

| Configuration | Serveurs | RAM Total | Comptes | CoÃ»t/mois | ComplexitÃ© |
|---------------|----------|-----------|---------|-----------|------------|
| **1 Serveur** | 1 Ã— 16GB | 16GB | 400 | 70â‚¬ | â­ Simple |
| **2 Serveurs** | 2 Ã— 16GB | 32GB | 800 | 105â‚¬ | â­â­ Moyen |
| **Cluster 7K** | 10 Ã— 32GB | 320GB | 7000 | 560â‚¬ | â­â­â­ AvancÃ© |

**Recommandation : Commencez par 1 serveur, puis scalez selon vos besoins !** ğŸ“ˆ
